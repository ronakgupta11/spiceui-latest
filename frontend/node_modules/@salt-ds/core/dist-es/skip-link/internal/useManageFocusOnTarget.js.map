{"version":3,"file":"useManageFocusOnTarget.js","sources":["../src/skip-link/internal/useManageFocusOnTarget.ts"],"sourcesContent":["import {\n  type FocusEventHandler,\n  type KeyboardEventHandler,\n  type MouseEventHandler,\n  type RefObject,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\";\n\nconst FOCUS_TIMEOUT = 50;\n\n// Props interface\ninterface ManageFocusOnTargetProps {\n  onBlur?: FocusEventHandler;\n  onClick?: MouseEventHandler;\n  onKeyUp?: KeyboardEventHandler;\n  targetRef: RefObject<HTMLElement> | undefined;\n  targetClass: string;\n}\n\n// Result interface\ninterface ManageFocusOnTargetResult {\n  onBlur?: FocusEventHandler<HTMLAnchorElement>;\n  onClick?: MouseEventHandler<HTMLAnchorElement>;\n  onKeyUp?: KeyboardEventHandler<HTMLAnchorElement>;\n}\nexport const useManageFocusOnTarget = ({\n  onKeyUp,\n  onBlur,\n  onClick,\n  targetRef,\n  targetClass,\n}: ManageFocusOnTargetProps): ManageFocusOnTargetResult => {\n  const [target, setTarget] = useState<HTMLElement>();\n\n  const hasTabIndex = useRef<boolean | string>();\n  const shouldRemoveTabIndex = useRef<boolean>();\n\n  useEffect(() => {\n    if (targetRef?.current) {\n      setTarget(targetRef.current);\n    }\n  }, [targetRef]);\n\n  if (!target) {\n    return {};\n  }\n\n  const addTabIndex = () => {\n    const tabIndex = target.getAttribute(\"tabIndex\");\n    hasTabIndex.current = tabIndex || tabIndex === \"0\";\n\n    if (!hasTabIndex.current) {\n      shouldRemoveTabIndex.current = true;\n      target.setAttribute(\"tabIndex\", \"-1\");\n    }\n  };\n\n  const removeTabIndex = () => {\n    if (!hasTabIndex.current && shouldRemoveTabIndex.current) {\n      target.removeAttribute(\"tabIndex\");\n    }\n  };\n\n  const handleFocusOnTarget = () => {\n    shouldRemoveTabIndex.current = false;\n    target.classList.add(targetClass);\n  };\n\n  const handleBlurFromTarget = () => {\n    shouldRemoveTabIndex.current = true;\n    removeTabIndex();\n    target.classList.remove(targetClass);\n  };\n\n  function moveToTarget() {\n    addTabIndex();\n    setTimeout(() => {\n      target?.focus();\n    }, FOCUS_TIMEOUT);\n\n    target?.addEventListener(\"focus\", handleFocusOnTarget, { once: true });\n    target?.addEventListener(\"blur\", handleBlurFromTarget, { once: true });\n  }\n\n  const handleKeyUp: KeyboardEventHandler<HTMLAnchorElement> = (event) => {\n    if (event.key === \"Enter\" || event.key === \" \") {\n      moveToTarget();\n    }\n    onKeyUp?.(event);\n  };\n\n  const handleClick: MouseEventHandler<HTMLAnchorElement> = (event) => {\n    moveToTarget();\n    onClick?.(event);\n  };\n\n  const handleBlur: FocusEventHandler<HTMLAnchorElement> = (event) => {\n    setTimeout(removeTabIndex, FOCUS_TIMEOUT);\n    onBlur?.(event);\n  };\n\n  return {\n    onBlur: handleBlur,\n    onClick: handleClick,\n    onKeyUp: handleKeyUp,\n  };\n};\n"],"names":[],"mappings":"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"}