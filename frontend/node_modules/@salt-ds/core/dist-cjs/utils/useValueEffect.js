'use strict';

var React = require('react');
var useEventCallback = require('./useEventCallback.js');
var useIsomorphicLayoutEffect = require('./useIsomorphicLayoutEffect.js');

function useValueEffect(defaultValue) {
  const [value, setValue] = React.useState(defaultValue);
  const effect = React.useRef(null);
  const nextRef = useEventCallback.useEventCallback(() => {
    if (!effect.current) {
      return;
    }
    const newValue = effect.current.next();
    if (newValue.done) {
      effect.current = null;
      return;
    }
    if (value === newValue.value) {
      nextRef();
    } else {
      setValue(newValue.value);
    }
  });
  useIsomorphicLayoutEffect.useIsomorphicLayoutEffect(() => {
    if (effect.current) {
      nextRef();
    }
  });
  const queue = useEventCallback.useEventCallback((fn) => {
    effect.current = fn(value);
    nextRef();
  });
  return [value, queue];
}

exports.useValueEffect = useValueEffect;
//# sourceMappingURL=useValueEffect.js.map
